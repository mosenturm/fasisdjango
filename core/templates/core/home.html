{% extends "base.html" %}
{% load crispy_forms_tags %}

{% block title %}
  Home
{% endblock %}

{% block heading %}
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="col-sm-3 col-md-2 sidebar">
        <ul class="nav nav-sidebar">
          <li class="active"><a href="#">Startseite <span class="sr-only">(aktuell)</span></a></li>
          <li><a href="{% url 'customer_table' %}">Kunden체bersicht</a></li>
          <li><a href="#">Test</a></li>
        </ul>
    </div>
    <div class="col-sm-9 col-md-10 main">
        <div class="alert alert-warning alert-dismissible" role="alert">
          <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
          <strong>Achtung!</strong> Das Wiedervorlagedatum kann jetzt mit Klick auf den Button ge채ndert werden.
        </div>
        <h1>FASIS Dashboard</h1>
        {% if reminders|length == 0 %}
           <div class="well well-sm">Aktuell sind keine Wiedervorlagen vorhanden.</div>
        {% endif %}
        {% if reminders|length > 0 %}
          <h3>Wiedervorlagen:</h3>
          <p>{{ reminders|length }} Wiedervorlage(n) aktuell</p>
          <table id="reminder_list" class="table table-striped table-bordered">
            <thead>
              <tr>
                <th>Kunde</th>
                <th>Wiedervorl.</th>
                <th>...</th>
              </tr>
            </thead>
            <tbody>
              {% for reminder in reminders %}
                <tr id="reminder-{{ reminder.pk }}">
                  {% if reminder.reminder|timesince >= "1 day" %}
                  <td class="danger">{{ reminder.cust_name }}</td>
                  <td class="danger">{{ reminder.reminder }}</td>
                  <td class="danger"><a class="btn btn-danger btn-xs btn-block" href="{% url 'renew_reminder' pk=reminder.pk %}" id="reminder-{{ reminder.pk }}"><span class="glyphicon glyphicon-pencil"></span></a>
                  </td>
                  {% else %}
                  <td>{{ reminder.cust_name }}</td>
                  <td>{{ reminder.reminder }}</td>
                  <td><a class="btn btn-info btn-xs btn-block" href="{% url 'renew_reminder' pk=reminder.pk %}" id="reminder-{{ reminder.pk }}"><span class="glyphicon glyphicon-pencil"></span></a>
                  </td>
                  {% endif %}
                </tr>
              {% endfor %}
            </tbody>
          </table>
        {% endif %}
    </div>
</div>

{% endblock %}
{% block javascript %}
<script>
    // individual data for specific pk for button click here in this function available
    //
    $('#reMinderModal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget); // Button that triggered the modal
      var reminder_id = button.data('reminderpk'); // Extract info from data-* attributes
      var reminder_name = button.data('remindername');
      var reminder_date = button.data('reminderdate');
      // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
      // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
      var modal = $(this)
      modal.find('.modal-title').text('Wiedervorlage f체r <br/>' + reminder_name)
      modal.find('.modal-body p').text("Dieses Datum: " + reminder_date + " 채ndern?")
    })    
</script>
{% endblock %}
